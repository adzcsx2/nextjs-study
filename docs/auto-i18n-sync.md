# 自动i18n翻译同步功能

## 📋 功能概述

现在您的开发环境支持**实时自动i18n翻译同步**功能！当您修改中文i18n文件时，系统会自动检测变化并使用腾讯云翻译API同步更新对应的英文翻译文件。

## 🚀 使用方法

### 方式一：集成开发模式（推荐）

```bash
npm run dev-with-i18n
```

这个命令会同时启动：
- Next.js 开发服务器
- i18n 文件监听器

### 方式二：分别启动

如果您想分别控制，可以使用：

```bash
# 启动 Next.js 开发服务器
npm run dev

# 在另一个终端中启动 i18n 监听器
npm run watch-i18n
```

## 📁 监听范围

监听器会自动监控以下目录中的文件变化：
- `src/i18n/lang/zh/` （中文翻译文件目录）
- 支持递归监听子目录
- 只监听 `.ts` 文件

## ⚡ 工作流程

1. **文件检测**：监听器实时检测中文i18n文件的变化
2. **防抖处理**：1秒防抖，避免频繁触发
3. **智能对比**：只翻译新增或修改的内容
4. **自动翻译**：使用腾讯云翻译API获取高质量翻译
5. **文件同步**：自动更新对应的英文翻译文件
6. **缓存更新**：更新翻译缓存，提高下次同步效率

## 🛠 特性

- ✅ **实时监听**：文件保存即触发同步
- ✅ **智能翻译**：优先使用腾讯云API，降级到本地词典
- ✅ **防抖机制**：避免频繁触发，提高效率  
- ✅ **错误恢复**：网络错误时自动降级到本地翻译
- ✅ **详细日志**：完整的翻译过程日志输出
- ✅ **缓存机制**：避免重复翻译，提高性能

## 📝 示例

当您在 `src/i18n/lang/zh/common.ts` 中添加：
```typescript
export default {
   // ... 其他内容
   newFeature: "新功能介绍",
}
```

监听器会自动检测并在 `src/i18n/lang/en/common.ts` 中添加：
```typescript
export default {
   // ... 其他内容  
   newFeature: "New Feature Introduction",
}
```

## 🔧 可用命令

| 命令 | 描述 |
|------|------|
| `npm run dev-with-i18n` | 启动开发服务器 + i18n监听器 |
| `npm run watch-i18n` | 仅启动i18n文件监听器 |
| `npm run sync-i18n` | 手动同步所有i18n文件 |
| `npm run sync-i18n-force` | 强制重新翻译所有内容 |
| `npm run sync-i18n-file` | 同步指定文件 |

## ⚙️ 配置要求

确保您的 `.env.local` 文件中配置了腾讯云翻译API：
```env
TENCENT_SECRET_ID=AKIDxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TENCENT_SECRET_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
TENCENT_REGION=ap-beijing
```

## 🔍 日志说明

监听器运行时会显示以下类型的日志：

- `📝 检测到文件变化` - 文件变化检测
- `🚀 开始同步翻译` - 开始翻译同步
- `🔄 使用腾讯云API翻译` - 正在使用API翻译
- `✅ 腾讯翻译成功` - 翻译成功
- `❌ 腾讯翻译失败` - 翻译失败，会降级到本地翻译
- `✅ 同步完成` - 整个同步过程完成

## 💡 最佳实践

1. **推荐使用 `npm run dev-with-i18n`** 来启动开发环境
2. **保存文件后稍等1秒** 让防抖机制完成，避免重复触发
3. **检查终端日志** 确认翻译是否成功
4. **定期检查英文文件** 确认翻译质量
5. **网络不稳定时** 系统会自动降级到本地词典翻译

## 🚫 停止监听

使用 `Ctrl+C` 可以安全停止监听器，系统会自动清理资源。

---

现在您可以专注于编写中文i18n内容，翻译同步完全自动化！🎉